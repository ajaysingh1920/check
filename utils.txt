this is the utility function for version1